<lg-header title="Plots" />

<lg-content-container class="flex-col space-y-4">
  <div class="flex flex-1 justify-between">
    <a
      class="app-button"
      [routerLink]="'/plot/editor'"
    >
      Neuer Plot
    </a>
    <div class="flex space-x-2">
      <button
        class="app-button"
        (click)="plots.reload()"
      >
        <fa-icon [icon]="faRefresh" />
      </button>
      <a
        class="app-button"
        [routerLink]="['/plot/info']"
      >
        <fa-icon [icon]="faInfoCircle" />
      </a>
      <a
        class="app-button"
        [routerLink]="['/plot/debug']"
      >
        <fa-icon [icon]="faBug" />
      </a>
    </div>
  </div>

  <h2>
    @let plotList = plots.value(); Liste erkannter Plots im Dokument:
    @if (plots.isLoading()) {
      <fa-icon
        [icon]="faRefresh"
        [animation]="'spin'"
      />
    } @else {
      {{ plotList.length }}
    }
  </h2>

  <div class="flex flex-col space-y-2">
    @let selectedPlot = wordService.selection();

    @for (plot of plotList; track plot.id; let index = $index) {
      @let isSelected = selectedPlot?.id === plot.id;
      <div
        class="rounded-sm p-2"
        [class.bg-brand-light]="isSelected"
        [class.odd:bg-gray-200]="!isSelected"
      >
        <div class="flex items-center space-x-1">
          <button
            class="flex-1 text-left font-bold"
            (click)="select(plot.id)"
          >
            <h3 [class.text-white]="isSelected">
              {{ plot.model?.name ?? 'Plot ' + index }}
            </h3>
          </button>
          <a
            class="app-button small"
            [routerLink]="['/plot/editor', plot.id]"
            ><fa-icon [icon]="faPen"
          /></a>
          <button
            class="app-button small"
            (click)="deletePlot(plot.id)"
          >
            <fa-icon [icon]="faTrashCan" />
          </button>
        </div>
      </div>
    }
  </div>
</lg-content-container>
